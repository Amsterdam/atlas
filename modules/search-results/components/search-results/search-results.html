<div class="c-search-results">
    <dp-loading-indicator is-loading="vm.isLoading" use-delay="true" show-inline="true"></dp-loading-indicator>

    <div ng-if="!vm.isLoading" class="u-row">
        <dp-tab-header ng-if="vm.showTabHeader()" search-text="{{vm.query}}" tab-header="vm.tabHeader"></dp-tab-header>

        <div ng-if="vm.numberOfResults" class="qa-search-result">
            <div ng-if="!vm.category">
                <dp-search-results-header
                    ng-if="!vm.showTabHeader()"
                    number-of-results="vm.numberOfResults"
                    query="{{vm.query}}"
                    location="vm.location">
                </dp-search-results-header>

                <div class="u-padding__top-2 u-padding__bottom--2" ng-class="{
                        'u-col-sm--12': !vm.location,
                        'u-col-sm--8': vm.location
                    }">

                    <div ng-repeat="category in vm.searchResults"
                         class="u-margin__bottom--4"
                         ng-class="{
                            's-indented-result': category.useIndenting,
                         }"
                         ng-if="category.count >= 1 || category.warning">

                        <div ng-if="!category.authLevel || vm.meetsRequiredLevel(category.authLevel)">

                            <h2 class="o-header__subtitle qa-search-header">
                                <span ng-if="category.count > 1">{{category.label_plural}} (<span class="qa-search-header-count">{{category.count | number}}</span>)</span>
                                <span ng-if="category.count === 1">{{category.label_singular}}</span>
                                <span ng-if="category.count === 0">{{category.label_plural}}</span>
                            </h2>

                            <dp-panel ng-if="category.warning" is-panel-visible="category.warning" type="warning" can-close="true" class="qa-category-warning">
                                {{ category.warning }}
                                Zie <dp-link-to-page item="item9"></dp-link-to-page>.
                            </dp-panel>

                            <dp-search-results-list category="category" limit-results="true"></dp-search-results-list>

                            <div ng-if="category.count > 10" class="qa-show-more">
                                <dp-link ng-if="category.more"
                                         class-name="c-show-more u-margin__top-05
                                             {{category.useIndenting ? '' : 'c-show-more--gray'}}"
                                         type="FETCH_DETAIL"
                                         payload="category.more.endpoint"
                                    >{{category.more.label}}</dp-link>

                                <dp-link ng-if="!category.more"
                                         class-name="c-show-more u-margin__top-05
                                             {{category.useIndenting ? '' : 'c-show-more--gray'}}"
                                         type="FETCH_SEARCH_RESULTS_CATEGORY"
                                         payload="category.slug"
                                    >Toon alle {{category.count | number}}</dp-link>
                            </div>

                        </div>
                    </div>

                    <dp-panel ng-if="!vm.meetsRequiredLevel('EMPLOYEE')" is-panel-visible="!vm.meetsRequiredLevel('EMPLOYEE')" type="warning" can-close="true" class="qa-category-warning">
                        <h3 class="c-panel__title">Meer resultaten na inloggen</h3>
                        <p class="c-panel__paragraph">Medewerkers/ketenpartners van Gemeente Amsterdam kunnen inloggen om meer te vinden: kadastrale subjecten, vestigingen en maatschappelijke activiteiten.
                        Zie <dp-link-to-page item="item9"></dp-link-to-page>.
                    </dp-panel>
                </div>

                <div ng-if="vm.location" class="u-col-sm--4">
                    <dp-straatbeeld-thumbnail location="vm.location"></dp-straatbeeld-thumbnail>
                </div>
            </div>
            <div ng-if="vm.category">
                <dp-search-results-header
                    number-of-results="vm.numberOfResults"
                    query="{{vm.query}}"
                    location="vm.location"
                    category="{{vm.category}}"
                    search-results="vm.searchResults">
                </dp-search-results-header>

                <div class="u-padding__top-2 u-padding__bottom--2" ng-class="{
                        'u-col-sm--12': !vm.location,
                        'u-col-sm--8': vm.location
                    }">

                    <dp-search-results-list category="(vm.searchResults | filter: { slug: vm.category })[0]"></dp-search-results-list>

                    <a ng-if="vm.hasLoadMore()"
                            class="c-show-more c-show-more--gray qa-show-more"
                            ng-click="vm.loadMore()"
                        >Toon meer</a>

                    <dp-loading-indicator is-loading="vm.isLoadMoreLoading" use-delay="true" show-inline="true">
                    </dp-loading-indicator>
                </div>

                <div ng-if="vm.location" class="u-col-sm--4">
                    <dp-straatbeeld-thumbnail location="vm.location"></dp-straatbeeld-thumbnail>
                </div>
            </div>
        </div>

        <div ng-if="vm.location && !vm.numberOfResults">
            <dp-search-results-header
                number-of-results="vm.numberOfResults"
                query="{{vm.query}}"
                location="vm.location">
            </dp-search-results-header>

            <div class="u-padding__top-2 u-padding__bottom--2" ng-class="{
                    'u-col-sm--12': !vm.location,
                    'u-col-sm--8': vm.location
                }">

                <p>Tip: maak de criteria minder specifiek (bijv. een straat i.p.v. specifiek adres)</p>
            </div>

            <div class="u-col-sm--4">
                <dp-straatbeeld-thumbnail location="vm.location"></dp-straatbeeld-thumbnail>
            </div>
        </div>
    </div>
</div>
