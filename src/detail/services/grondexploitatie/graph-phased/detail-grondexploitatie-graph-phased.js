import { batenCategories, batenCategoryLabels } from '../categories';
import { displayFactor, precisionRound } from '../helpers';

const generateGraphData = ({ baten: { jaren } }) => (
  jaren.map((year) => ({
    name: year.name,
    categories: batenCategories.some((category) => {
      const item = year.categories[category] || {};
      return item.begroot || item.begroot === 0;
    }) && batenCategories.map((category) => {
      const item = year.categories[category] || {};
      const begroot = item.begroot || 0;
      const begrootValue = begroot / displayFactor;
      const begrootRounded = precisionRound(begrootValue, 1);
      const begrootTooSmallLabel = begrootValue ? '<0,05' : '';
      const begrootLabel = begrootRounded ? `${begrootRounded}`.replace('.', ',') : begrootTooSmallLabel;
      return {
        begroot,
        begrootLabel,
        begrootValue,
        id: category,
        name: batenCategoryLabels[category]
      };
    })
  }))
);

const getMax = ({ baten: { max_jaren_axis_begroot } }) =>
  // eslint-disable-next-line camelcase
  Math.round(max_jaren_axis_begroot / displayFactor);

export {
  generateGraphData,
  getMax
};
