import { CATEGORIES } from '../grondexploitatie-categories';

import generateGraphData, { precisionRound } from './grafiek-totale-begroting.service';

describe('Grondexploitatie Grafiek Totale Begroting Service', () => {
  describe('precisionRound', () => {
    it('should complete the number correctly', () => {
      const number = precisionRound(0.55345, 2);
      expect(number).toBe(0.55);
    });

    it('should complete the number correctly', () => {
      const number = precisionRound(0.55645, 2);
      expect(number).toBe(0.56);
    });

    it('should complete the number correctly', () => {
      const number = precisionRound(0.54345, 1);
      expect(number).toBe(0.5);
    });

    it('should complete the number correctly', () => {
      const number = precisionRound(0.55645, 1);
      expect(number).toBe(0.6);
    });
  });

  describe('generateGraphData', () => {
    const mockApiData = [
      {
        categorie: CATEGORIES.BEDRIJFSRUIMTE,
        totaal: { begroot: 5000000 }
      },
      {
        categorie: CATEGORIES.KANTOORRUIMTE,
        totaal: { begroot: 500000 }
      }
    ];

    it('should return the data in correct format', () => {
      const graphData = generateGraphData(mockApiData);
      const findItem = (category) => graphData.find((item) => item.name === category);
      expect(findItem(CATEGORIES.KANTOORRUIMTE)).toEqual({
        name: CATEGORIES.KANTOORRUIMTE,
        value: {
          label: '0,5',
          value: 0.5
        }
      });
      expect(findItem(CATEGORIES.BEDRIJFSRUIMTE)).toEqual({
        name: CATEGORIES.BEDRIJFSRUIMTE,
        value: {
          label: '5',
          value: 5
        }
      });
      expect(findItem(CATEGORIES.COMMERCIEEL)).toEqual({
        name: CATEGORIES.COMMERCIEEL,
        value: {
          label: '0',
          value: 0
        }
      });
    });
  });
});
