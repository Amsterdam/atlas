import { totaleBegrotingCategories, CATEGORY_LABELS } from '../grondexploitatie-categories';

const AMOUNT = 1000000;

const precisionRound = (number, precision) => {
  const factor = Math.pow(10, precision); //eslint-disable-line
  return Math.round(number * factor) / factor;
};

const generateGraphData = (data) => (
  totaleBegrotingCategories.map((category) => {
    const existingItem = data.find((item) => item.categorie === category);
    const begrootRounded = existingItem && precisionRound(existingItem.totaal.begroot / AMOUNT, 1);
    const geboektRounded = existingItem && precisionRound(existingItem.totaal.geboekt / AMOUNT, 1);
    return {
      name: CATEGORY_LABELS[category],
      id: category,
      begroot: {
        value: existingItem ? existingItem.totaal.begroot / AMOUNT : 0,
        label: begrootRounded ? `${begrootRounded}`.replace('.', ',') : ''
      },
      geboekt: {
        value: existingItem ? existingItem.totaal.geboekt / AMOUNT : 0,
        label: geboektRounded ? `${geboektRounded}`.replace('.', ',') : ''
      }
    };
  }));

export default generateGraphData;
