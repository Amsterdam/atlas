import React from 'react';
import PropTypes from 'prop-types';
import { Legend, BarChart, Bar, XAxis, YAxis, CartesianGrid, ResponsiveContainer, Cell, LabelList, Rectangle } from 'recharts';

import CustomLegenda from '../legenda/CustomLegenda';
import { getGrondexploitatieCategoryColor } from '../../../services/grondexploitatie/grafieken/grondexploitatie-categories';
import './_grondexploitatie-grafiek-totale-begroting.scss';

const CustomBar = (props) => {
  const { fill, x, y, width, height } = props;
  return <Rectangle fill={fill} x={x} y={y} width={width} height={height / 2} />;
};

CustomBar.defaultProps = {
  fill: '',
  x: 0,
  y: 0,
  width: 0,
  height: 0
};

CustomBar.propTypes = {
  fill: PropTypes.string,
  x: PropTypes.number,
  y: PropTypes.number,
  width: PropTypes.number,
  height: PropTypes.number
};

const GrondexploitatieGrafiekTotaleBegroting = ({ data }) => (
  <div className="grondexploitatie-grafiek-totale-begroting">
    <h3 className="grondexploitatie-grafiek-totale-begroting__title">
      Totale begroting
    </h3>
    <div className="grondexploitatie-grafiek-totale-begroting__container">
      <ResponsiveContainer
        width="100%"
        aspect={4.0 / 2.5}
        minWidth={400}
        minHeight={300}
      >
        <BarChart
          width={300}
          height={200}
          maxBarSize={100}
          layout="vertical"
          data={data}
        >
          <XAxis
            tickLine={false}
            axisLine={false}
            type="number"
            label={{ value: 'Miljoenen', position: 'insideBottom', offset: -10 }}
            tick={{ fill: '#999' }}
            domain={['auto', (dataMax) => Math.round(dataMax * 1.1)]}
          />
          <YAxis
            width={180}
            tickLine={false}
            axisLine={false}
            hide={false}
            dataKey="name"
            type="category"
            tick={{ fill: '#999' }}
          />
          <CartesianGrid
            horizontal={false}
            fill="#f6f6f6"
          />
          <Legend
            wrapperStyle={{ bottom: '-20px' }}
            content={<CustomLegenda />}
          />
          <Bar
            name="category"
            dataKey="begroot.value"
          >
            {
              data.map((entry) => (
                <Cell
                  fill={getGrondexploitatieCategoryColor(entry.id)}
                  key={entry.name}
                />
              ))
            }
            <LabelList
              dataKey="begroot.label"
              position="right"
            />
          </Bar>
          <Bar
            name="realized"
            dataKey="geboekt.value"
            fill="#808080"
            shape={<CustomBar />}
          >
            <LabelList
              dataKey="geboekt.label"
              position="right"
            />
          </Bar>
        </BarChart>
      </ResponsiveContainer>
    </div>
  </div>
);

GrondexploitatieGrafiekTotaleBegroting.defaultProps = {
  data: []
};

GrondexploitatieGrafiekTotaleBegroting.propTypes = {
  data: PropTypes.array // eslint-disable-line
};

export default GrondexploitatieGrafiekTotaleBegroting;
